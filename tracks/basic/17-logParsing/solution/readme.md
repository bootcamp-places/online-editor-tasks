# logParsing

–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è —Ü—ñ—î—ó –∑–∞–¥–∞—á—ñ –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –æ—Å—å —Ç–∞–∫:

```js
export const logParsing = (string = "") => {
  // 1. –í–∏–¥—ñ–ª–∏—Ç–∏ –∫–æ–∂–Ω–∏–π –∑–∞–ø–∏—Å (–º—ñ—Å—Ç–∏—Ç—å—Å—è –º—ñ–∂ —Ñ—ñ–≥—É—Ä–Ω–∏–º–∏ –¥—É–∂–∫–∞–º–∏)
  const records = string.match(/{([\s\S]*?)}/gm);
  // 2. –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É: —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –∑–∞–ø–∏—Å –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç–∏
  const completeRecords = records.filter(
    // 3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, —â–æ —ó—Ö —Ä—ñ–≤–Ω–æ 6, —Ç–æ–±—Ç–æ –∑–∞–ø–∏—Å —î –ø–æ–≤–Ω–∏–º
    (record) => record.split("\n").length === 6
  );

  const result = [];
  // 4. –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–æ–≤–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É
  completeRecords.forEach((record) => {
    const rows = record.split("\n");
    const elementsPosition = {
      timestamp: 0,
      "server-id": 1,
      message: 2,
    };
    const finalRecord = [];
    rows.forEach((row) => {
      const isRequiredRow = /timestamp|server-id|message/.test(row);
      if (isRequiredRow) {
        const key = row.slice(2, 17).replace("mulog/", "").trim();
        // –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤
        const value = row.slice(17).trim().replace(/[",}]/g, "");
        finalRecord[elementsPosition[key]] = value;
        // (—á–∞—Å –∫–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –≤ —Ñ–æ—Ä–º–∞—Ç ISO)
        if (key === "timestamp") {
          finalRecord[0] = new Date(+finalRecord[0]).toISOString().slice(0, 10);
        }
      }
    });
    // —ñ –¥–æ–¥–∞—Ç–∏ –¥–æ –≤–∏—Ö—ñ–¥–Ω–æ—ó —Å—Ç—Ä–æ–∫–∏
    result.push(finalRecord.join(";"));
  });
  // 5. –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ –∑–∞–∫—ñ–Ω—á–µ–Ω—É –≤–∏—Ö—ñ–¥–Ω—É —Å—Ç—Ä–æ–∫—É
  return result.join("\n");
};
```

–¶—é –∑–∞–¥–∞—á—É –º–æ–∂–Ω–∞ –≤–∏—Ä—ñ—à–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç—ñ–ª—å–∫–∏ —Ü–∏–∫–ª—ñ–≤ `for` —Ç–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ —Å—Ç—Ä–æ–∫–∏. –ê–ª–µ –∫–æ–¥ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –±—ñ–ª—å—à –∫–æ—Ä–æ—Ç–∫–∏–º —ñ –∑—Ä–æ–∑—É–º—ñ–ª–∏–º, —è–∫—â–æ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏ —Å—Ç—Ä–æ–∫—É —è–∫ –º–∞—Å–∏–≤ (–ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–≤—à–∏ —ó—ó –Ω–∞ –º–∞—Å–∏–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫ –±—É–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –∑–∞–¥–∞—á—ñ [arrToString](js-track/basic/arrToString)) —ñ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω—ñ –º–µ—Ç–æ–¥–∏ –º–∞—Å–∏–≤—É –¥–ª—è —ñ—Ç–µ—Ä—É–≤–∞–Ω–Ω—è.

–†–æ–∑–±–µ—Ä–µ–º–æ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è —Ü—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è, –∞ —Ç–∞–∫–æ–∂ —Ç—Ä–æ—Ö–∏ –ø–µ—Ä–µ—Ä–æ–±–∏–º–æ –π–æ–≥–æ.

–ü–µ—Ä—à–∏–π –ø—É–Ω–∫—Ç –∑–≤—É—á–∏—Ç—å —Ç–∞–∫: "–í–∏–¥—ñ–ª–∏—Ç–∏ –∫–æ–∂–Ω–∏–π –∑–∞–ø–∏—Å (–º—ñ—Å—Ç–∏—Ç—å—Å—è –º—ñ–∂ —Ñ—ñ–≥—É—Ä–Ω–∏–º–∏ –¥—É–∂–∫–∞–º–∏)". –¢–æ–±—Ç–æ –Ω–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ —ñ—Ç–µ—Ä—É–≤–∞—Ç–∏ –∑–∞–¥–∞–Ω—É —Å—Ç—Ä–æ–∫—É —ñ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —É—Å–µ –≤ –∑–º—ñ–Ω–Ω—ñ. –ü–æ—á–Ω–µ–º–æ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü–∏–∫–ª—É `for` —Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —É–º–æ–≤–∏ `if`.

```js
let currentIndex = 0; // –¢—É—Ç –∑–±–µ—Ä—ñ–≥–∞—î–º–æ —ñ–Ω–¥–µ–∫—Å –Ω–∞–π–¥–µ–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É
let result = []; // –ó–∞–ø–∏—Å–∏ –±—É–¥–µ–º–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —É –º–∞—Å–∏–≤—ñ
// –Ü—Ç–µ—Ä—É—î–º–æ (—Ç–æ–±—Ç–æ –ø–µ—Ä–µ–±–∏—Ä–∞—î–º–æ) –∫–æ–∂–Ω–∏–π —Å–∏–º–≤–æ–ª –≤—Ö—ñ–¥–Ω–æ—ó —Å—Ç—Ä–æ–∫–∏
let start; // –ú–∞—Ä–∫–µ—Ä –ø–æ—á–∞—Ç–∫—É –∑–∞–ø–∏—Å—É
for (let i = 0; i <= string.length; i++) {
  if (string[i] === "{") { // –Ø–∫—â–æ –º–∏ –∑—É—Å—Ç—Ä—ñ–ª–∏ –ø–æ—á–∞—Ç–æ–∫ –∑–∞–ø–∏—Å—É,
    start = i; // —Ç–æ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ —Ç—É—Ç –º–∞—Ä–∫–µ—Ä
  }
  if (string[i] === "}")  { // –Ø–∫—â–æ —Ü–µ –∫—ñ–Ω–µ—Ü—å –∑–∞–ø–∏—Å—É
    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –Ω–∞–π–¥–µ–Ω–∏–π –∑–∞–ø–∏—Å
    result[currentIndex] = string.substring(start + 1, i);
    // –Ü –∑–±—ñ–ª—å—à—É—î–º–æ —ñ–Ω–¥–µ–∫—Å –∑–∞–ø–∏—Å—ñ–≤ –Ω–∞ –æ–¥–∏–Ω –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É
    currentIndex++;
  }
}
console.log(result); // <- –¢—É—Ç –∑–∞–ø–∏—Å–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

–ê–ª–µ —Ü–µ –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ—Å–ª—ñ–≤–Ω–æ, –±–æ —É JavaScript —ñ—Å–Ω—É—î —Å–ø–æ—Å—ñ–± –∫—Ä–∞—â–∏–π –∑–∞ —Ü–µ–π - –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ [—Ä–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Cheatsheet).

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å–µ, —â–æ –º—ñ—Å—Ç–∏—Ç—å—Å—è –º—ñ–∂ —Ñ—ñ–≥—É—Ä–Ω–∏—Ö –¥—É–∂–æ–∫, –Ω–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫—Ä—É–≥–ª–∏—Ö –¥—É–∂–æ–∫ —ñ –≤–∫–∞–∑–∞—Ç–∏, —â–æ –º–∏ –ø—Ä–∏–π–º–∞—î–º–æ –±—É–¥—å-—è–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å (—Ç–æ–±—Ç–æ `*`) –±—É–¥—å-—è–∫–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ (—Ç–æ–±—Ç–æ `.`):

```js
const records = string.match(/{(.*)}/gm);
```

–ê–ª–µ –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î–º–æ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–Ω–æ—Å—É —Å—Ç—Ä–æ–∫–∏, —Ç–æ–º—É –ø–µ—Ä–µ–ø–∏—à–µ–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

```js
const records = string.match(/{([\s\S]*?)}/gm);
```

–Ø–∫ –±–∞—á–∏—Ç–µ, –±—ñ–ª—å—à–µ –¥–µ—Å—è—Ç–∏ —Å—Ç—Ä–æ–∫ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∫–æ–¥—É –º–∏ –∑–∞–º—ñ–Ω–∏–ª–∏ –æ–¥–Ω—ñ—î—é, —Ç–æ–º—É –Ω–∞–¥–∞–ª—ñ –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω—ñ –º–µ—Ç–æ–¥–∏, –∫–æ–ª–∏ –≤–æ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ.

–ù–∞—Å—Ç—É–ø–Ω—ñ –¥–≤–∞ –ø—É–Ω–∫—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É –≤–∏–º–∞–≥–∞—é—Ç—å, —â–æ–± –º–∏ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞–ª–∏ –æ—Ç—Ä–∏–º–∞–Ω–∏–π –º–∞—Å–∏–≤, –∑–∞–ª–∏—à–∏–≤—à–∏ —Ç—ñ–ª—å–∫–∏ —Ç—ñ –∑–∞–ø–∏—Å–∏, —â–æ –º—ñ—Å—Ç—è—Ç—å –ø–æ–≤–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, —Ç–æ–±—Ç–æ —Ä—ñ–≤–Ω–æ 6. –û—Å–∫—ñ–ª—å–∫–∏ –º–∏ –∑–Ω–∞—î–º–æ, —â–æ –æ–¥–∏–Ω –∑–∞–ø–∏—Å –≤—ñ–¥–±–∏—Ç–∏–π –≤—ñ–¥ —ñ–Ω—à–æ–≥–æ —Å–∏–º–≤–æ–ª–æ–º `\n`, —Ç–æ –º–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –º–µ—Ç–æ–¥ `split` —ñ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –¥–æ–≤–∂–∏–Ω—É –æ—Ç—Ä–∏–º–∞–Ω–æ–≥–æ –º–∞—Å–∏–≤—É:

```js
const completeRecords = records.filter(
  (record) => record.split("\n").length === 6
);
```

–í –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É, —á–µ—Ç–≤–µ—Ä—Ç–æ–º—É –ø—É–Ω–∫—Ç—ñ –∞–ª–≥–æ—Ä–∏—Ç–º—É, –Ω–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –≤–∏—á–ª–µ–Ω–∏—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —ñ –∑–±–µ—Ä–µ–≥—Ç–∏ —ó—Ö –≤ —Ç–∏–º—á–∞—Å–æ–≤—É –∑–º—ñ–Ω–Ω—É. –û—Å–∫—ñ–ª—å–∫–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —Ü–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —î –¥–æ–≤—ñ–ª—å–Ω–æ—é, —Ç–æ –¥–ª—è –ø–æ—à—É–∫—É, –Ω–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ–∂–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç –∑–∞–ø–∏—Å—É, –ø–æ—Ä—ñ–≤–Ω—é—é—á–∏ –∑ –±–∞–∂–∞–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º. –¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `if`, –∞–ª–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –º–µ—Ç–æ–¥ `test`, –±–æ –≤ —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É, –º–∏ –º–æ–∂–µ–º–æ –∑–∞–¥–∞—Ç–∏ —É—Å—ñ –ø–æ—à—É–∫–æ–≤—ñ —Ç–µ—Ä–º—ñ–Ω–∏, —Ä–æ–∑–¥—ñ–ª–∏–≤—à–∏ —ó—Ö —Å–∏–º–≤–æ–ª–æ–º `|`.

**–£–≤–∞–≥–∞:** –ú–∏ –Ω–µ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑ –≤ —è–∫–æ—Å—Ç—ñ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø–æ—à—É–∫—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –º–µ—Ç–æ–¥ —Å—Ç—Ä–æ–∫–∏ `includes`, –±–æ –≤—ñ–Ω –≤–∏–∫–∏–Ω–µ `TypeError`. –°–∞–º–µ —Ç–æ–º—É, –¥–ª—è —Ü—å–æ–≥–æ –≤–∏–ø–∞–¥–∫—É –∑—Ä—É—á–Ω—ñ—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –º–µ—Ç–æ–¥ —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤ `test`.

```js
const isRequiredRow = /timestamp|server-id|message/.test(row);
```

–û—Å–∫—ñ–ª—å–∫–∏ –º–∏ –∑–Ω–∞—î–º–æ, —â–æ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –∑–∞–≤–∂–¥–∏ —Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—ñ –≤—ñ–¥—Å—Ç—É–ø–∞–º–∏, —Ç–æ–±—Ç–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ —Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ–π –ø–æ–∑–∏—Ü—ñ—ó –≤—ñ–¥–Ω–æ—Å–Ω–æ –∫–ª—é—á–∞,

```text
 :mulog/timestamp  1664789750262,
 :server-id        "S01"
 :message          "Some text here1"}
```

—Ç–æ –º–∏ –º–æ–∂–µ–º–æ —Å–º—ñ–ª–æ –≤—ñ–¥—Ä—ñ–∑–∞—Ç–∏ —á–∞—Å—Ç–∏–Ω—É —Å—Ç—Ä–æ–∫–∏, –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ 17-—ó –ø–æ–∑–∏—Ü—ñ—ó —ñ –¥–æ –∫—ñ–Ω—Ü—è, –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è. –ü—Ä–∏ —Ü—å–æ–º—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏, —â–æ –º–∏ –º–æ–∂–µ–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ —Ç—Ä–æ—Ö–∏ –ø—Ä–æ–±—ñ–ª—ñ–≤, –∞ —Ç–∞–∫–æ–∂ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–π–≤—ñ —Å–∏–º–≤–æ–ª–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–º—É `,` –≤ –∫—ñ–Ω—Ü—ñ `mulog/timestamp`). –¢–æ–º—É –ø—Ä–æ–±—ñ–ª–∏ –º–∏ –º–æ–∂–µ–º–æ –≤–∏–¥–∞–ª–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ `trim`, –∞ –∑–∞–π–≤—ñ —Å–∏–º–≤–æ–ª–∏ - –º–µ—Ç–æ–¥–æ–º `replace`. –©–æ–± –∑–∞–¥–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–æ–¥–∏–Ω–æ–∫–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ —É —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –≤–∏—Ä–∞–∑—ñ, —è–∫—ñ –º–∏ —Ö–æ—á–µ–º–æ –≤–∏–¥–∞–ª–∏—Ç–∏, —Ç—Ä–µ–±–∞ —ó—Ö –ø–µ—Ä–µ–ª—ñ—á–∏—Ç–∏ —É –∫–≤–∞–¥—Ä–∞—Ç–Ω–∏—Ö –¥—É–∂–∫–∞—Ö, —Ç–æ–±—Ç–æ `[",}]`. –¢–∞–∫–∏–º —á–∏–Ω–æ–º –º–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –Ω–∞—Å—Ç—É–ø–Ω–µ:

```js
const value = row.slice(17).trim().replace(/[",}]/g, "");
```

–ó–∞–ª–∏—à–∞—î—Ç—å—Å—è –æ–¥–Ω–µ –Ω–µ–≤–∏—Ä—ñ—à–µ–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è: —è–∫–∏–º —á–∏–Ω–æ–º —Ä–æ–∑–º—ñ—Å—Ç–∏—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ —É –∑–∞–¥–∞–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É, —è–∫—â–æ –Ω–∞ –≤—Ö–æ–¥—ñ —Ç–æ–≥–æ –ø–æ—Ä—è–¥–∫—É –Ω–µ–º–∞—î? –¢–æ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–æ–º–∞ —Å–ø–æ—Å–æ–±–∞–º–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ `if`-–æ–º, —è–∫–∏–π –º–∏ –º–∞—î–º–æ –∑–∞—Ä–∞–∑ –∫–ª—é—á, —â–æ–± –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –π–æ–≥–æ —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ–π —Ç–∏–º—á–∞—Å–æ–≤—ñ–π –∑–º—ñ–Ω–Ω—ñ–π —ñ –ø–æ—Ç—ñ–º —Å–∫–ª–µ—ó—Ç–∏ —ó—Ö:

```js
// –ù–∞ –ø–æ—á–∞—Ç–∫—É —Ü–∏–∫–ª—É
let timestamp, server, message;
  // –£ —Å–∞–º–æ–º—É —Ü–∏–∫–ª—ñ
  const value = row.slice(17).trim().replace(/[",}]/g, "");
  if (row.includes('timestamp')) {
    timestamp = value;
  } else if // —ñ —Ç–∞–∫ –¥–∞–ª—ñ –¥–ª—è –≤—Å—ñ—Ö –∫–ª—é—á—ñ–≤
// –Ü –ø—ñ—Å–ª—è —Ü–∏–∫–ª—É
const result = timestamp + ";" + server + ";" + value;
```

–ê–ª–µ —î –±—ñ–ª—å—à –∫—Ä–∞—Å–∏–≤–∏–π —Å–ø–æ—Å—ñ–±, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –∫–ª—é—á—ñ–≤ –¥–æ –ø–æ–∑–∏—Ü—ñ–π —ñ –ø–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω–∏–π –∫–ª—é—á –∑ —Ü—ñ—î—é —Ç–∞–±–ª–∏—Ü–µ—é.

```js
// –ù–∞ –ø–æ—á–∞—Ç–∫—É —Ü–∏–∫–ª—É —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é
const elementsPosition = {
  timestamp: 0,
  "server-id": 1,
  message: 2,
};
const finalRecord = []; // –ê —Ç—É—Ç –∑–±–µ—Ä–µ–∂–µ–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
// –£ —Å–∞–º–æ–º—É —Ü–∏–∫–ª—ñ, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ —Ü–µ –æ–¥–∏–Ω —ñ–∑ –æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
const isRequiredRow = /timestamp|server-id|message/.test(row);
if (isRequiredRow) {
  // –û—Ç—Ä–∏–º—É—î–º–æ –π–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è —è–∫ —ñ —Ä–∞–Ω—ñ—à–µ
  const value = row.slice(17).trim().replace(/[",}]/g, "");
  // –Ü –æ—Ç—Ä–∏–º—É—î–º–æ –∫–ª—é—á (–¥–ª—è timestamp —Ç—Ä–µ–±–∞ –≤—ñ–¥—Ä—ñ–∑–∞—Ç–∏ –ø—Ä–µ—Ñ—ñ–∫—Å mulog)
  const key = row.slice(2, 17).replace("mulog/", "").trim();
  // –ó–∞–ø–∏—Å—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –∫–æ–º—ñ—Ä–∫—É –º–∞—Å–∏–≤—É
  finalRecord[elementsPosition[key]] = value;
// –Ü –ø—ñ—Å–ª—è —Ü–∏–∫–ª—É
result.push(finalRecord.join(";"));
```

–Ñ–¥–∏–Ω–µ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è, —è–∫–µ –Ω–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ - —á–∞—Å `timestamp`. –¢—ñ–ª—å–∫–∏ –¥–ª—è —Ü—å–æ–≥–æ –∫–ª—é—á–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –π–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è —É —Ñ–æ—Ä–º–∞—Ç ISO.

```js
if (key === "timestamp") {
  const timestamp = +finalRecord[0]; // `+` –∫–æ–Ω–≤–µ—Ä—Ç—É—î —Å—Ç—Ä–æ–∫—É —É —á–∏—Å–ª–æ
  const time = new Date(timestamp); // –°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–± º—î–∫—Ç –¥–∞—Ç–∏ –∑ —á–∏—Å–ª–∞
  // –û—Ç—Ä–∏–º–∞—î–º–æ —â–æ—Å—å —Ç–∞–∫–µ: Tue Oct 04 2022 12:22:49 GMT+0200, —Ç–æ–º—É
  const timeISO = time.toISOString(); // –∫–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ —É 2022-10-04T10:22:38.917Z
  // –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –¥–∞—Ç—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç—ñ–ª—å–∫–∏ –ø–µ—Ä—à—ñ 10 —Å–∏–º–≤–æ–ª—ñ–≤
  finalRecord[0] = timeISO.slice(0, 10); // -> 2022-10-04
}
```

–ó–∞–ª–∏—à–∏–ª–æ—Å—å —Ç—ñ–ª—å–∫–∏ –æ–± º—î–¥–Ω–∞—Ç–∏ —á–µ—Ä–µ–∑ `;` –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —É —î–¥–∏–Ω–∏–π –∑–∞–ø–∏—Å —ñ –ø–æ—Ç—ñ–º —Å–∫–ª–µ—ó—Ç–∏ —É—Å—ñ –∑–∞–ø–∏—Å–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∏–º–≤–æ–ª—É `\n`.

–¢–µ–ø–µ—Ä —É—Å–µ –ø—Ä–∞—Ü—é—î! üöÄ

–¶—é –∑–∞–¥–∞—á—É –º–æ–∂–Ω–∞ –≤–∏—Ä—ñ—à–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É `reduce` (—è–∫ –±—É–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ —É —Ä—ñ—à–µ–Ω–Ω—ñ –∑–∞–¥–∞—á—ñ [logConverting](js-track/objects/logConverting)). –í —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –º–æ–∂–µ–º–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥, –æ–¥—Ä–∞–∑—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–¥–Ω—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ—ó —è–∫ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω–Ω—ñ –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ—ó, –∞ —Ç–∞–∫–æ–∂ –æ–±—ñ–π—Ç–∏—Å—å –±–µ–∑ –±–∞–≥–∞—Ç—å–æ—Ö —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö.

```js
export const logParsing = (string = "") => {
  const elementsPosition = {
    timestamp: 0,
    "server-id": 1,
    message: 2,
  };

  return string
    .match(/{([\s\S]*?)}/gm)
    .filter((record) => record.split("\n").length === 6)
    .reduce((result, record) => {
      result.push(
        record
          .split("\n")
          .reduce((final, row) => {
            if (/timestamp|server-id|message/.test(row)) {
              const key = row.slice(2, 17).replace("mulog/", "").trim();
              const value = row.slice(17).trim().replace(/[",}]/g, "");
              final[elementsPosition[key]] =
                key === "timestamp"
                  ? new Date(+value).toISOString().slice(0, 10)
                  : value;
            }
            return final;
          }, [])
          .join(";")
      );
      return result;
    }, [])
    .join("\n");
};
```

–ù–µ–¥–æ–ª—ñ–∫–æ–º —Ü—å–æ–≥–æ —Ä—ñ—à–µ–Ω–Ω—è —î —Ç–æ, —â–æ –≤–æ–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é –±—ñ–ª—å—à–µ –ø–∞–º º—è—Ç—ñ —ñ –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ, –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –≤–µ–ª–∏—á–∏–Ω–∏ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –í —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É, –º–æ–∂–Ω–∞ –ø–æ–ª—ñ–ø—à–∏—Ç–∏ —Ü–µ —Ä—ñ—à–µ–Ω–Ω—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≤ –æ–±–æ—Ö —Ü–∏–∫–ª–∞—Ö `reduce` –ø—É—Å—Ç—É —Å—Ç—Ä–æ–∫—É –∑–∞–º—ñ—Å—Ç—å –º–∞—Å–∏–≤—É –∏ —Å–∫–ª–µ—é–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥—Ä–∞–∑—É. –°–ø—Ä–æ–±—É—î—Ç–µ –ø–æ–∫—Ä–∞—â–∏—Ç–∏? ü§ì

## –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

[Date.prototype.toISOString](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString)

[–¢—É—Ç –º–æ–∂–Ω–∞ –±—ñ–ª—å—à–µ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏](https://stackoverflow.com/questions/5642315/regular-expression-to-get-a-string-between-two-strings-in-javascript), —è–∫ –º–æ–∂–Ω–∞ –≤–∏–¥—ñ–ª—è—Ç–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –º—ñ–∂ –¥–≤–æ–º–∞ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏

[String.prototype.match](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match)

[String.prototype.includes](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes)

[RegExp.prototype.test](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test)

[String.prototype.split](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split)

[String.prototype.trim](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)

[String.prototype.replace](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace)

[Array.prototype.filter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter)

[Array.prototype.forEach](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach)

[Array.prototype.reduce](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce)
